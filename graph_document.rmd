---
title: "Graphs"
author: "Xavier Marquez"
date: "2023-02-08"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE)

library(targets)
library(tidyverse)
```

## Combined Graphs

```{r graph_combined_weights_all_models_all_terms, fig.cap="Terms related to 'DEMOCRACY', average over all models, all terms."}
tar_load(graph_combined_weights)

graph_combined_weights[[1]]

```

```{r graph_combined_weights_all_models_nouns, fig.cap="Terms related to 'DEMOCRACY', average over all models, nouns only."}
graph_combined_weights[[2]]

```

```{r graph_combined_weights_all_models_verbs, fig.cap="Terms related to 'DEMOCRACY', average over all models, verbs only."}
graph_combined_weights[[3]]

```

```{r graph_combined_weights_all_models_verbs, fig.cap="Terms related to 'DEMOCRACY', average over all models, adjectives only."}
graph_combined_weights[[4]]

```


```{r graph_combined_weights_all_models_verbs, fig.cap="Terms related to 'DEMOCRACY', average over all models, terms ending in ism."}
graph_combined_weights[[5]]

```

## Model performance graphs

```{r combined_performance_graph, fig.cap="Predictive performance of classification models."}
tar_load(combined_performance)

combined_performance %>% 
  dplyr::filter(.estimator == "binary") %>% 
  # dplyr::mutate(.estimate = case_when(.metric == "roc_auc" ~ 1 - .estimate,
  #                                     TRUE ~ .estimate)) %>%
  ggplot2::ggplot(ggplot2::aes( x= decade, y = .estimate, color = .metric, alpha = forcats::fct_rev(sample))) + 
  ggplot2::geom_point() + 
  ggplot2::geom_line() + 
  ggplot2::facet_wrap(.metric~ stringr::str_extract(source, "(xgboost|LiblineaR)(_sampled)?"),
                      scales = "free_y") +
  ggplot2::theme_bw() +
  ggplot2::labs(alpha = "Sample", color = "Metric")

```

```{r combined_performance_graph2, fig.cap="Predictive performance of regression models."}
combined_performance %>% 
  dplyr::filter(.estimator == "standard") %>% 
  ggplot2::ggplot(ggplot2::aes( x= decade, y = .estimate, color = .metric, alpha = forcats::fct_rev(sample))) + 
  ggplot2::geom_point() + 
  ggplot2::geom_line() + ggplot2::facet_wrap(.metric ~ stringr::str_extract(source, "(xgboost|LiblineaR)(_sampled)?")) +
  ggplot2::theme_bw() +
  ggplot2::labs(alpha = "Sample", color = "Metric")

```

